/*! JoindIn.js 0.5.0 | Aurelio De Rosa (@AurelioDeRosa) | MIT/GPL-3.0 Licensed */
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b):"object"==typeof module&&module.exports?module.exports=b():a.JoindIn=b()}(this,function(){"use strict";function a(a,b,c){for(var d=0;d<b.length;d++)a.setAttribute(b[d],c[d]);return a}function b(a,b,c){for(var d=0;d<b.length;d++)a[b[d]]=c[d];return a}function c(a,b){for(var c=0;c<b.length;c++)a.appendChild(b[c]);return a}function d(a){var b=0;if(0===a.length)return b;for(var c=0;c<a.length;c++)b+=a[c];return Math.round(b/a.length)}function e(a){return b(u("img"),["src","alt"],[s.replace(/RATING/,a),"Rate "+a+" of 5"])}function f(a){var d,e,f=u("dl");for(var g in a)a.hasOwnProperty(g)&&(d=b(u("dt"),["textContent"],[g+": "]),e=b(u("dd"),["textContent"],[a[g]]),c(f,[d,e]));return f}function g(d,e){var f,g,h,i,j,k;g=u("div"),g.className="icon-wrapper",e.icon&&(f=a(u("img"),["src"],[t+e.icon]),g.appendChild(f)),h=u("div"),h.className="info-wrapper",i=b(u("h1"),["textContent"],[e.name]),j=b(u("a"),["href","innerHTML"],[e.website_uri,i.outerHTML]),k=b(u("a"),["href","textContent"],[e.href,e.href]),c(h,[j,k]),c(d,[g,h])}function h(a,b){var d=u("ul"),e=b.events.map(function(a){var b=u("li");return g(b,a),b});a.className+=" joindin-cfps",c(d,e),a.appendChild(d)}function i(d,e){var g,h,i,j,k,l,m,n,o;g=e.events[0],h=g.icon?a(u("img"),["src"],[t+g.icon]):document.createTextNode(""),i=b(u("h1"),["textContent"],[g.name]),j=b(u("a"),["href","innerHTML"],[g.website_uri,i.outerHTML]),k=b(u("a"),["href","textContent"],[g.href,g.href]),l=b(u("time"),["textContent"],[new Date(g.start_date).toDateString()]),a(l,["datetime"],[g.start_date]),m=b(u("time"),["textContent"],[new Date(g.end_date).toDateString()]),a(m,["datetime"],[g.end_date]),n=b(u("p"),["textContent"],[g.description]),o=f({Attendees:g.attendee_count,Tracks:g.tracks_count,Talks:g.talks_count}),d.className+=" joindin-event",c(d,[h,j,k,l,document.createTextNode(" - "),m,n,document.createTextNode("Other info about the event:"),o])}function j(a,f){var g,h,i,j,k,l="http://joind.in/user/view/";0!==f.talks.length&&(j=f.talks[0].speakers[0],g=b(u("h1"),["textContent"],[j.speaker_name]),h=b(u("a"),["href","innerHTML"],[l+j.speaker_uri.slice(j.speaker_uri.lastIndexOf("/")+1),g.outerHTML]),i=e(d(f.talks.map(function(a){return a.average_rating}))),k=b(u("span"),["textContent"],["("+f.talks.length+" talks)"]),a.className+=" joindin-speaker",c(a,[h,i,k]))}function k(d,f){var g,h,i,j,k,l,m,n,o;g=f.comments[0],h=b(u("blockquote"),["cite"],[g.talk_uri]),a(h,["itemprop","itemscope","itemtype"],["review","","http://schema.org/Review"]),l=b(u("div"),["className"],["text-wrapper"]),k=a(u("p"),["itemprop"],["description"]),b(k,["textContent"],[g.comment]),m=a(u("cite"),["itemprop"],["author"]),b(m,["textContent"],[g.user_display_name]),n=a(u("time"),["datetime","itemprop"],[g.created_date,"datePublished"]),b(n,["textContent"],[new Date(g.created_date).toLocaleString()]),o=e(g.rating),j=b(u("div"),["className","innerHTML"],["rating-wrapper",o.outerHTML]),i=c(u("footer"),[document.createTextNode("â€” "),m,document.createTextNode(" on "),n]),c(l,[k,i]),c(h,[j,l]),d.className+=" joindin-talk-comment",d.appendChild(h)}function l(a,d){var f,g,h,i,j,k;f=d.talks[0],g=b(u("h1"),["textContent"],[f.talk_title]),h=b(u("a"),["href","innerHTML"],[f.website_uri,g.outerHTML]),i=b(u("p"),["textContent"],[f.talk_description]),j=b(u("span"),["textContent"],[f.speakers.map(function(a){return a.speaker_name}).join(" , ")]),k=e(f.average_rating),a.className+=" joindin-talk",c(a,[h,j,k,i])}function m(a,b){b||(b=function(){});var c=new XMLHttpRequest;c.addEventListener("readystatechange",function(){return c.readyState<4?void 0:c.status>=200&&c.status<300||304===c.status?void b(c):void b(c)}),c.open("GET",a,!0),c.send()}function n(a){var b,c=p[a.getAttribute("data-type")],d=a.getAttribute("data-id"),e=r;if("cfps"===c)e+="events?filter=cfp",b=h;else if("events"===c)e+=c+"/"+d,b=i;else if("talk_comments"===c)e+=c+"/"+d,b=k;else if("talks"===c)e+=c+"/"+d,b=l;else{if("users"!==c)throw new Error("Data type not recognized");e+=c+"/"+d+"/talks",b=j}m(e+"?format=json",function(c){b(a,JSON.parse(c.response))})}function o(){[].forEach.call(document.querySelectorAll(q),n)}var p={cfps:"cfps",event:"events",speaker:"users",talk:"talks","talk-comment":"talk_comments"},q=".joindin-embed",r="http://api.joind.in/v2.1/",s="https://joind.in/inc/img/rating-RATING.gif",t="https://joind.in/inc/img/event_icons/",u=document.createElement.bind(document);return{init:o}});